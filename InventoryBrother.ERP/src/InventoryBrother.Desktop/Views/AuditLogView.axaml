<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:InventoryBrother.Desktop.ViewModels"
             xmlns:loc="using:InventoryBrother.Desktop.Extensions"
             x:Class="InventoryBrother.Desktop.Views.AuditLogView"
             x:DataType="vm:AuditLogViewModel">

    <Grid RowDefinitions="Auto, * " Margin="20">
        <StackPanel Grid.Row="0" Spacing="20" Margin="0,0,0,20">
            <TextBlock Text="{loc:Localize AuditTrail}" FontSize="24" FontWeight="Bold"/>
            
            <StackPanel Orientation="Horizontal" Spacing="10">
                <TextBox Text="{Binding SearchKey}" Watermark="Search by Table or Action..." Width="300"/>
                <Button Content="{loc:Localize Search}" Command="{Binding SearchCommand}" Classes="primary"/>
                <Button Content="{loc:Localize Refresh}" Command="{Binding LoadLogsCommand}"/>
            </StackPanel>
        </StackPanel>

        <Border Grid.Row="1" Background="White" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5">
            <DataGrid ItemsSource="{Binding AuditLogs}" 
                      AutoGenerateColumns="False" 
                      IsReadOnly="True"
                      GridLinesVisibility="All">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Timestamp" Binding="{Binding Timestamp}" Width="180"/>
                    <DataGridTextColumn Header="Table" Binding="{Binding TableName}" Width="150"/>
                    <DataGridTextColumn Header="Action" Binding="{Binding Action}" Width="100"/>
                    <DataGridTextColumn Header="Key" Binding="{Binding PrimaryKey}" Width="120"/>
                    <DataGridTextColumn Header="Old Values" Binding="{Binding OldValues}" Width="*"/>
                    <DataGridTextColumn Header="New Values" Binding="{Binding NewValues}" Width="*"/>
                </DataGrid.Columns>
            </DataGrid>
        </Border>

        <ProgressBar Grid.Row="1" VerticalAlignment="Top" IsIndeterminate="True" IsVisible="{Binding IsBusy}"/>
    </Grid>
</UserControl>
